{% extends 'user_templates/user_base.html' %}
{% load static %}
{% block content %}




     <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
						<!--begin::Subheader-->
						<div  class="subheader py-6 py-lg-8 subheader-transparent" id="kt_subheader">
							<div class="container d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
								<!--begin::Info-->
								<div class="d-flex align-items-center flex-wrap mr-1">
									<!--begin::Page Heading-->
									<div class="d-flex align-items-baseline flex-wrap mr-5">
										<!--begin::Page Title-->
										<h5 class="text-dark font-weight-bold my-1 mr-5">Dashboard</h5>
										<!--end::Page Title-->
									</div>
									<!--end::Page Heading-->
								</div>
								<!--end::Info-->
								<!--begin::Toolbar-->
								<div class="d-flex align-items-center flex-wrap">
									<!--begin::Daterange-->
									<a href="#" class="btn btn-fixed-height btn-bg-white btn-text-dark-50 btn-hover-text-primary btn-icon-primary font-weight-bolder font-size-sm px-5 my-1 mr-3" id="kt_dashboard_daterangepicker" data-toggle="tooltip" title="Select dashboard daterange" data-placement="top">
										<span class="opacity-60 font-weight-bolder mr-2" id="kt_dashboard_daterangepicker_title">Today</span>
										<span class="font-weight-bolder" id="kt_dashboard_daterangepicker_date">Aug 16</span>
									</a>
									<!--end::Daterange-->
								</div>
								<!--end::Toolbar-->
							</div>
						</div>
						<!--end::Subheader-->
						<!--begin::Entry-->
						<div  class="d-flex flex-column-fluid">
							<!--begin::Container-->
							<div class="container">


   <div class="flex-row-fluid ml-lg-8">
										<!--begin::Card-->
										<div class="card card-custom card-stretch">
											<!--begin::Header-->
											<div class="card-header py-1">
												<div class="card-title align-items-start flex-column">
													<h3 class="card-label font-weight-bolder text-dark">Application Status</h3>
													<span class="text-muted font-weight-bold font-size-sm mt-1"></span>
												</div>
                                                {% if show_leave_status.status == 'rejected' %}
												<div class="card-toolbar">
                                                <h3 class="card-label font-weight-bolder text-dark mr-4">Status : </h3>
													<button type="reset" class="btn btn-danger font-weight-bolder mr-4" id="leave_update"> {{ show_leave_status.status }}</button>
{#													<button type="reset" class="btn btn-light-primary font-weight-bolder" onClick="window.location.reload();">Cancel</button>#}
												</div>
											</div>
                                                    {% else %}
                                                    {% if show_leave_status.status == 'request' %}
                                                    	<div class="card-toolbar">
                                                            <h3 class="card-label font-weight-bolder text-dark mr-4">Status : </h3>
													<button type="reset" class="btn btn-warning font-weight-bolder mr-2" id="leave_update">{{ show_leave_status.status }}</button>
{#													<button type="reset" class="btn btn-light-primary font-weight-bolder" onClick="window.location.reload();">Cancel</button>#}
												</div>
											</div>
                                                     {% else %}

                                                    	<div class="card-toolbar">
                                                            <h3 class="card-label font-weight-bolder text-dark mr-4">Status : </h3>
													<button type="reset" class="btn btn-primary font-weight-bolder mr-2" id="leave_update">{{ show_leave_status.status }}</button>
{#													<button type="reset" class="btn btn-light-primary font-weight-bolder" onClick="window.location.reload();">Cancel</button>#}
												</div>
											</div>
                                            {% endif %}
                                            {% endif %}
{#                                            {% endif %}#}
											<!--end::Header-->
											<!--begin::Form-->
											<form method="POST">
												<!--begin::Body-->
                                                {% csrf_token %}
												<div class="card-body">
													<div class="row">
														<label class="col-xl-3"></label>
														<div class="col-lg-9 col-xl-6">
{#															<h5 class="font-weight-bold mb-6">Customer Info</h5>#}
														</div>
													</div>


                                                    <div class="form-group row">
														<label class="col-xl-3 col-lg-3 col-form-label text-right">Reason</label>
														<div class="col-lg-9 col-xl-6">
															<textarea class="form-control form-control-lg form-control-solid" id="reason" type="text" readonly>{{ show_leave_status.reason }}</textarea>
														</div>
													</div>
													<div class="form-group row">
														<label class="col-xl-3 col-lg-3 col-form-label text-right">Days</label>
														<div class="col-lg-9 col-xl-6">
															<input class="form-control form-control-lg form-control-solid" id="leave_days" type="text" value="{{ show_leave_status.leave_days }}" readonly/>
														</div>
													</div>
                                                    <div class="form-group row">
                                                        <label class="col-xl-3 col-lg-3 col-form-label text-right">Starting Day</label>
														<div class="col-lg-9 col-xl-6">
                                                            <input type="date" class="form-control form-control-lg form-control-solid" name="start_date" id="start_date" value="{{ show_leave_status.start_date }}"readonly/>
                                                        </div>
													</div>
                                                     <div class="form-group row">
                                                        <label class="col-xl-3 col-lg-3 col-form-label text-right">Ending Day</label>
														<div class="col-lg-9 col-xl-6">
                                                            <input type="date" class="form-control form-control-lg form-control-solid" name="end_date" id="end_date" value="{{ show_leave_status.end_date }}" readonly/>
                                                        </div>
													</div>
{#                                                    <div class="form-group row">#}
{#														<label class="col-xl-3 col-lg-3 col-form-label text-right">Description</label>#}
{#														<div class="col-lg-9 col-xl-6">#}
{#															<textarea class="form-control form-control-lg form-control-solid" id="description" type="text" readonly >{{ show_leave_status.description }}</textarea>#}
{#														</div>#}
{#													</div>#}
{#                                                    <div class="form-group row">#}
{#                                                        <label class="col-xl-3 col-lg-3 col-form-label text-right">Status</label>#}
{#                                                        <div class="col-lg-9 col-xl-6">#}
{#                                                            <select class="form-control form-control-lg form-control-solid" id="Billable_Status" name="Billable_Status" value="" readonly>#}
{#                                                                <option class="form-control form-control-lg form-control-solid" selected>{{ show_leave_status.Billable_Status}}</option>#}
{#                                                                <option class="form-control form-control-lg form-control-solid">half day</option>#}
{#                                                            </select>#}
{#                                                         </div>#}
{#                                                </div>#}
                                                    {% if show_leave_status.rejected_reason  != '' %}
                                                    <div>
                                                        <div class="form-group row">
														<label class="col-xl-3 col-lg-3 col-form-label text-right">Rejected Reason</label>
														<div class="col-lg-9 col-xl-6">
                                                            <textarea class="form-control form-control-lg form-control-solid" id="leave_days" type="text" readonly>{{ show_leave_status.rejected_reason }}</textarea>
														</div>
													</div>
                                                        {% endif %}
                                                {% if show_leave_status.status  == 'rejected' %}
                                                             <div align="center">
                                            <a href="{% url 'edit_leave_request' show_leave_status.id  %}"><button type="button" id="edit_leave_request" class="btn btn-danger font-weight-bolder mr-2">Edit and Send</button></a>
                                             <a href="{% url 'leave_apply_table' %}" ><button type="button"   class="btn btn-primary font-weight-bolder mr-2" >Back</button></a>
                                        </div>

                                                {% else %}
                                                <div align="center">
{#                                            <a href="{% url 'edit_leave_request' show_leave_status.id  %}"><button type="button" id="edit_leave_request" class="btn btn-primary font-weight-bolder mr-2">Edit and Send</button></a>#}
                                             <a href="{% url 'leave_apply_table' %}" ><button type="button"   class="btn btn-primary font-weight-bolder mr-2" >Back</button></a>
                                        </div>
                                                 {% endif %}


                                                        <input class="form-control form-control-solid form-control-lg" value="{{ request.user.emp_id }}" id="emp_id" name="emp_id" type="hidden" placeholder="Current Password" />
                                                        <input class="form-control form-control-solid form-control-lg" value="{{ request.user.username }}" id="username" name="username" type="hidden" placeholder="Current Password" />
                                                    </div>
                                                </div>
											</form>


										</div>



								<!--begin::Dashboard-->
								<!--begin::Row-->
								<!--end::Dashboard-->
							</div>
							<!--end::Container-->
						</div>
						<!--end::Entry-->
					</div>
    <script src="{% static 'js/user_page_js/delete_leave_request.js' %}"></script>
    <script>

     $(document).on('click','#delete_leave_request',function() {

                        var id = $(this).data("value");
                        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
{#alert(id)#}
                    Swal.fire({
                        title: "Are you sure you want to Remove?",
                        text:"",
                        icon: "warning",
                        showCancelButton: true,
                        confirmButtonText: "Yes",
                        cancelButtonText: "No"
                    }).then(function(result) {
                        if (result.value) {

                                  $.ajax({
                                  url: "{% url 'delete_leave_request' %}",
            	                method :'POST',
            	                headers: {'X-CSRFToken': csrftoken},
                                 data: {
                                     'id': id,
                                 },
                                success: function (dataResult) {
                                    // if (dataResult === 'no'){

                                        Swal.fire({
                                            position: "center",
                                            icon: "success",
                                            title: "Application has been Removed...!",
                                            showConfirmButton: false,
                                            timer: 1500
                                        }).then(function (){
                                           window.location.href="{%  url 'leave_apply_table' %}"
                                        });

                                }
                            });

                        } else if (result.dismiss === "cancel") {
                             Swal.fire({
                                 position: "center",
                                 icon: "error",
                                 title: "Application Not Removed :)",
                                 showConfirmButton: false,
                                 timer: 1500
                             });
                        }
                    });


                });
    </script>
{% endblock content %}