{% extends 'admin_templates/admin_base.html' %}


 {% block timelog %}

         <a href="#" class="btn btn-primary font-weight-bolder mr-4" data-toggle="modal" data-target="#timelogmodal">
											<span class="svg-icon svg-icon-md">
												<!--begin::Svg Icon | path:assets/media/svg/icons/Design/Flatten.svg-->
												<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
													<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
														<rect x="0" y="0" width="24" height="24" />
														<circle fill="#000000" cx="9" cy="15" r="6" />
														<path d="M8.8012943,7.00241953 C9.83837775,5.20768121 11.7781543,4 14,4 C17.3137085,4 20,6.6862915 20,10 C20,12.2218457 18.7923188,14.1616223 16.9975805,15.1987057 C16.9991904,15.1326658 17,15.0664274 17,15 C17,10.581722 13.418278,7 9,7 C8.93357256,7 8.86733422,7.00080962 8.8012943,7.00241953 Z" fill="#000000" opacity="0.3" />
													</g>
												</svg>
												<!--end::Svg Icon-->
											</span>time log</a>

      <div class="modal fade" id="timelogmodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
     {% for a in username %}
      <div class="modal-header text-center">

        <h4 class="modal-title w-100 font-weight-bold">Today Time Log : {{ a.username }}</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
    {% endfor %}
<center>
<table class="table table-hover" >
    <thead>
        <tr>
            <th>No</th>
            <th >Clockin Time</th>
            <th>Clockout Time</th>
            <th>Duration</th>
        </tr>

    </thead>
    <tbody>
    {% for a in today_log %}

    <tr>
    <td>{{ forloop.counter }}</td>
        <td>{{ a.user_clockin_time }}</td>
        <td>{{ a.user_clockout_time }}</td>
    <td>{{ a.user_total_hours }}</td>

    </tr>
    {% endfor %}
    </tbody>
</table>

</center>


{#        <h1>{{ a.emp_id }}</h1>#}


      <div class="modal-footer d-flex justify-content-center">
{#        <button class="btn btn-danger font-weight-bolder mr-2" id="user_leave_rejected">Reject</button>#}
      </div>
    </div>
  </div>
</div>



    {% endblock timelog %}
{% block content %}
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.css"/>



<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
						<!--begin::Subheader-->
						<div  class="subheader py-6 py-lg-8 subheader-transparent" id="kt_subheader">
							<div class="container d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
								<!--begin::Info-->
								<div class="d-flex align-items-center flex-wrap mr-1">
									<!--begin::Page Heading-->
									<div class="d-flex align-items-baseline flex-wrap mr-5">
										<!--begin::Page Title-->
										<h5 class="text-dark font-weight-bold my-1 mr-5">Dashboard</h5>
										<!--end::Page Title-->
									</div>
									<!--end::Page Heading-->
								</div>
								<!--end::Info-->
								<!--begin::Toolbar-->

								<div class="d-flex align-items-center flex-wrap">
                                             <a href="#" class="btn btn-primary font-weight-bolder mr-4" data-toggle="modal" data-target="#timelogmodal">
											<span class="svg-icon svg-icon-md">
												<!--begin::Svg Icon | path:assets/media/svg/icons/Design/Flatten.svg-->
												<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
													<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
														<rect x="0" y="0" width="24" height="24" />
														<circle fill="#000000" cx="9" cy="15" r="6" />
														<path d="M8.8012943,7.00241953 C9.83837775,5.20768121 11.7781543,4 14,4 C17.3137085,4 20,6.6862915 20,10 C20,12.2218457 18.7923188,14.1616223 16.9975805,15.1987057 C16.9991904,15.1326658 17,15.0664274 17,15 C17,10.581722 13.418278,7 9,7 C8.93357256,7 8.86733422,7.00080962 8.8012943,7.00241953 Z" fill="#000000" opacity="0.3" />
													</g>
												</svg>
												<!--end::Svg Icon-->
											</span>time log</a>

									<a href="#" class="btn btn-fixed-height btn-bg-white btn-text-dark-50 btn-hover-text-primary btn-icon-primary font-weight-bolder font-size-sm px-5 my-1 mr-3" id="kt_dashboard_daterangepicker" data-toggle="tooltip" title="Select dashboard daterange" data-placement="top">
										<span class="opacity-60 font-weight-bolder mr-2" id="kt_dashboard_daterangepicker_title">Today</span>
										<span class="font-weight-bolder" id="kt_dashboard_daterangepicker_date">Aug 16</span>
									</a>



								</div>
								<!--end::Toolbar-->
							</div>
						</div>
						<!--end::Subheader-->
						<!--begin::Entry-->
						<div  class="d-flex flex-column-fluid">
							<!--begin::Container-->
							<div class="container">


                     
								
  				
      
      <div class="card card-custom down">
									<div class="card-header">
										<div class="card-title">
											<h3 class="card-label">Employee Attendance Calendar</h3>
										</div>
										<div class="card-toolbar">
											<a href="#" class="btn btn-light-primary font-weight-bold">
											<i class="ki ki-plus icon-md mr-2"></i>Add Event</a>
										</div>
									</div>
									<div class="card-body">
										<div id="kt_calendar"></div>
									</div>
								</div>

  




							
							<!--end::Container-->
						</div>
						<!--end::Entry-->
					</div>


    <div class="modal fade" id="timelogmodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
     {% for a in username %}
      <div class="modal-header text-center">

        <h4 class="modal-title w-100 font-weight-bold">Today Time Log : {{ a.username }}</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
    {% endfor %}
<center>
<table class="table table-hover" >
    <thead>
        <tr>
            <th>No</th>
            <th >Clockin Time</th>
            <th>Clockout Time</th>
            <th>Duration</th>
        </tr>

    </thead>
    <tbody>
    {% for a in today_log %}

    <tr>
    <td>{{ forloop.counter }}</td>
        <td>{{ a.user_clockin_time }}</td>
        <td>{{ a.user_clockout_time }}</td>
    <td>{{ a.user_total_hours }}</td>

    </tr>
    {% endfor %}
    </tbody>
</table>

</center>


{#        <h1>{{ a.emp_id }}</h1>#}


      <div class="modal-footer d-flex justify-content-center">
{#        <button class="btn btn-danger font-weight-bolder mr-2" id="user_leave_rejected">Reject</button>#}
      </div>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.js"></script>
<script>

var KTCalendarBasic = function() {

    return {
        //main function to initiate the module
        init: function() {
            var todayDate = moment().startOf('day');
            var YM = todayDate.format('YYYY-MM');
            var YESTERDAY = todayDate.clone().subtract(1, 'day').format('YYYY-MM-DD');
            var TODAY = todayDate.format('YYYY-MM-DD');
            var TOMORROW = todayDate.clone().add(1, 'day').format('YYYY-MM-DD');

            {#var dates = #}

            var calendarEl = document.getElementById('kt_calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {
                plugins: [ 'bootstrap', 'interaction', 'dayGrid', 'timeGrid', 'list' ],
                themeSystem: 'bootstrap',

                isRTL: KTUtil.isRTL(),

                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay'
                },

                height: 800,
                contentHeight: 780,
                aspectRatio: 3,  // see: https://fullcalendar.io/docs/aspectRatio

                nowIndicator: true,
                now: TODAY + 'T09:25:00', // just for demo

                views: {
                    dayGridMonth: { buttonText: 'month' },
                    timeGridWeek: { buttonText: 'week' },
                    timeGridDay: { buttonText: 'day' }
                },

                defaultView: 'dayGridMonth',
                defaultDate: TODAY,

                editable: true,
                eventLimit: true, // allow "more" link when too many events
                navLinks: true,
                events: [
                    {% for i in total_users %}
                        {
                        start: '{{ i.user_current_date }}',
                        title: '{{ i.attendance_form }}',
                        // description: 'present',
                        className: "fc-event-success fc-event-solid-{{i.calender_form}}"
                        } ,

                    {% endfor %}

                ],

                eventRender: function(info) {
                    var element = $(info.el);

                    if (info.event.extendedProps && info.event.extendedProps.description) {
                        if (element.hasClass('fc-day-grid-event')) {
                            element.data('content', info.event.extendedProps.description);
                            element.data('placement', 'top');
                            KTApp.initPopover(element);
                        } else if (element.hasClass('fc-time-grid-event')) {
                            element.find('.fc-title').append('<div class="fc-description">' + info.event.extendedProps.description + '</div>');
                        } else if (element.find('.fc-list-item-title').lenght !== 0) {
                            element.find('.fc-list-item-title').append('<div class="fc-description">' + info.event.extendedProps.description + '</div>');
                        }
                    }
                }
            });

            calendar.render();
        }
    };
}();

jQuery(document).ready(function() {
    KTCalendarBasic.init();
});
</script>
{% endblock content %}